<div class="row-fluid">

  <!-- Loading spinner: visibility defined by $scope.doneLoading  -->
  <div ng-hide="doneLoading" style="text-align: center; padding: 20px;">
    <img src="/img/ajax-loader.gif" style="text-align: center;" />
    <p style="text-align: center; color: #64ABC0; margin-top: 20px;">
      <strong><message key="view.message.certificateloading" /></strong>
    </p>
  </div>

  <div ng-show="doneLoading">
    <!-- Modals: visibility defined by $scope.doneLoading -->
    <div modal="shouldBeOpen" close="close()" options="opts">
      <div class="modal-header">
        <button class="close" ng-click="close()">×</button>
        <h3>Intyget har skickats till Försäkringskassan</h3>
      </div>
      <div class="modal-body">
        <p>Ärendet behandlas nu av Försäkringskassan.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-success" ng-click="close()">OK</button>
      </div>
    </div>

    <div id="backnav" class="row-fluid">
      <a class="backlink" href="/web/start"><message key="button.goback" /></a>
    </div>



    <!-- Content -->

    <div class="row-fluid">
      <div class="span7">
        <h1>
          <message key="view.label.pagetitle" />
        </h1>
        <p>
          <message key="view.label.pagedescription" />
        </p>
        <form id="view-as-pdf" action="/api/certificate/dfb6d8a7-47f1-4a76-9bf2-7bc712298dc5.pdf" method="get" target="_blank">
          <p class="btn-row">
            <button type="button" ng-click="open()" class="btn btn-success">
              <message key="button.send" />
            </button>
            <button id="downloadprint" type="submit" class="btn btn-inverse">
              <message key="button.downloadprint" />
            </button>
          </p>
        </form>
      </div>
      <div class="span5 eventbox">
        <h2>Senaste händelsen</h2>
        <p>Inga händelser</p>
        <!--  <ul>
        <li>Skickat till Försäkringskassan</li>
      </ul>
      <a href="#allEventsModal" role="button" data-toggle="modal" onclick="return false">Visa alla händelser</a> -->
      </div>
    </div>
    <section id="certificate" class="certificate">
      <span class="hide" id="certId" title="{{cert.id}}"></span> <span class="hide" id="certType" title="{{cert.typ}}"></span>
      <div class="row-fluid">
        <div class="span12">
          <div class="cert">
            <div class="cert-titlebar">
              <div class="row-fluid">
                <div class="span6">
                  <h2>
                    <span><message key="view.label.certtitle" /></span>
                  </h2>
                </div>
                <div class="span5 issue">
                  <span><message key="view.label.issued" /></span> <span class="cert-titlebar-value">{{cert.signeringsdatum | date:'longDate'}}</span>
                </div>
                <div class="span1 archive">
                  <a href="#archiveModal" role="button" data-toggle="modal" onclick="return false"><img alt="Arkivera intyg" src="/img/archive-icon.gif" /></a>
                </div>
              </div>
            </div>
            <div class="cert-header">
              <div class="row-fluid">
                <div class="span6">
                  <span class="tag"><message key="view.label.patientname" /></span> <span id="patient-name">{{cert.patient.fullstandigtNamn}}</span>
                </div>
                <div class="span6">
                  <span class="tag"><message key="view.label.unit" /></span> <span id="careunit">{{cert.utfardare.vardenhet.enhetNamn}}</span>
                </div>
              </div>
              <div class="row-fluid">
                <div class="span6">
                  <span class="tag"><message key="view.label.civicnumber" /></span> <span id="patient-crn">{{cert.patient.personId}}</span>
                </div>
                <div class="span6">
                  <span class="tag"><message key="view.label.issuer" /></span> <span id="caregiver">{{cert.utfardare.vardenhet.vardgivare.vardgivareNamn}}</span>
                </div>
              </div>
              <div class="row-fluid">
                <div class="span6">
                  <span class="tag"><message key="view.label.period" /></span> <span id="certificate-period">{{cert.giltighetsperiod.startDatum | date:'longDate'}}&ndash;{{cert.giltighetsperiod.slutDatum | date:'longDate'}} </span>
                </div>
                <div class="span6"></div>
              </div>
            </div>
            <div class="cert-body">
              
				  <div class="body-row">
	              	<h3>Information om den avbeställda resan</h3>
	                <span class="title">Bokningsnummer</span> <span id="travel-booking-ref" class="text">{{cert.arrangemang.bokningsreferens}}</span><br/>
	                <span class="title">Resmål</span> <span id="travel-destination" class="text">{{cert.arrangemang.plats}}</span><br/>
	                <span class="title">Datum då resan bokades</span> <span id="travel-booking-date" class="text">{{cert.arrangemang.bokningsdatum | date:'longDate'}}</span><br/>
	                <span class="title">Datum för avresa</span> <span id="travel-departure-date" class="text">{{cert.arrangemang.arrangemangstid.startDatum | date:'longDate'}}</span><br/>
	                <span class="title">Datum då resan avbeställdes</span> <span id="travel-cancel-date" class="text">{{cert.arrangemang.avbestallningsdatum | date:'longDate'}}</span>
	              </div>
	              <div class="body-row" ng-switch on="cert.tillstand.orsakAvbokning">
	              	<h3>Rekommendation</h3>
	              	<span ng-switch-when="RESENAR_SJUK_RESBAR">Jag avråder ej från resa. Patientens = resenärens tillstånd utgör inget hinder för resa.</span>
	                <span ng-switch-when="RESENAR_SJUK_EJ_RESBAR">Jag avråder uttryckligen från resa, då patientens = resenärens tillstånd innebär, att sådan ej kan genomföras utan men.</span>
	                <span ng-switch-when="RESENAR_GRAVID_RESBAR">Jag avråder ej från resa. Graviditeten utgör inget medicinskt hinder för resa.</span>
	                <span ng-switch-when="RESENAR_GRAVID_EJ_RESBAR">Jag avråder uttryckligen från resa. Komplikationer i graviditeten har uppkommit efter bokning av resa, vilka innebär hinder för resa.</span>
	                
	              </div>
	              <div class="body-row" ng-show="cert.tillstand.orsakAvbokning == 'RESENAR_GRAVID_RESBAR'">
	              	<span>Barnet beräknas födas {{cert.tillstand.resenarGravid.beraknadForlossning}}</span>
	              </div>
	              <div class="body-row">
	              	<h3>Om den akutella sjukdomen/komplikationen</h3>
	                <span class="title">Datum för första undersökning</span> <span id="examination-first-date" class="text">{{cert.undersokning.forstaundersokningDatum | date:'longDate'}}</span><br/>
	                <span class="title">Plats för första undersökning</span> <span id="examination-first-place" class="text">{{cert.undersokning.forstaundersokningPlats}}</span><br/>             
	                <span class="title">Datum för undersökning</span> <span id="examination-date" class="text">{{cert.undersokning.undersokningDatum | date:'longDate'}}</span><br/>
	                <span class="title">Plats för undersökning</span> <span id="examination-place" class="text">{{cert.undersokning.undersokningPlats}}</span>
	              </div>
	              <div class="body-row" ng-show="cert.undersokning.komplikationStatus != 'KOMPLIKATION_BESKRIVES'" ng-switch on="cert.undersokning.komplikationStatus">
	                <span ng-switch-when="KOMPLIKATION_OKAND">Sjukdomen/komplikationen var okänd vid bokningstillfället.</span>
	                <span ng-switch-when="KOMPLIKATION_KAND_FORVARRATS_EJ_FORUTSAGBART">Patientens sjukdom/komplikation är kronisk, var känd vid inbokningstillfället och utgjorde då inget hinder för resan. Tillståndet har nu förvärrats på ett sätt som vid bokningstillfället ej var möjligt att förutse</span>
	                <span ng-switch-when="KOMPLIKATION_KAND_FORVARRATS_FORUTSAGBART">Patientens sjukdom/komplikation är kronisk, var känd vid inbokningstillfället och utgjorde då inget hinder för resan. Tillståndet har nu förvärrats på ett sätt som vid bokningstillfället var möjligt att förutse</span>
	              </div>
	              <div class="body-row" ng-show="cert.undersokning.komplikationStatus == 'KOMPLIKATION_BESKRIVES'">
	              	<span>{{cert.undersokning.komplikationBeskrivning}}</span>
	              </div>
	              <div class="body-row">
	              	<h3>Utfärdare</h3>
	              	<span class="title">Läkare</span> <span id="physician-name-id" class="text">{{cert.utfardare.hosPersonal.fullstandigtNamn}} ({{cert.utfardare.hosPersonal.personId}})</span><br/>
	              	<span class="title">Vårdgivare</span> <span id="caregiver-name-id" class="text">{{cert.utfardare.vardenhet.vardgivare.vardgivareNamn}} ({{cert.utfardare.vardenhet.vardgivare.vardgivareId}})</span><br/>
	                <span class="title">Vårdenhetens namn och id</span> <span id="careunit-name-id" class="text">{{cert.utfardare.vardenhet.enhetNamn}} ({{cert.utfardare.vardenhet.enhetId}})</span><br/>
	                <span class="title">Postadress</span> <span id="careunit-postal_address" class="text">{{cert.utfardare.vardenhet.postadress}}, {{cert.utfardare.vardenhet.postnummer}} {{cert.utfardare.vardenhet.postort}}</span>
	              </div>

            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

</div>
