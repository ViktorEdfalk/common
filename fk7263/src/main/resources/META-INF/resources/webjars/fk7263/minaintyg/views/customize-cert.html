<div class="row-fluid">
  <div mi-spinner label="fk7263.message.certificateloading" show-spinner="!doneLoading" show-content="doneLoading">

    <!-- Content -->
    <div class="row">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
        <h1 ng-focus="pagefocus" tabindex="-1">
          <span message key="fk7263.customize.step.1.pagetitle"></span>
        </h1>
        <div class="row-fluid">
          <div class="wizard">
            <ul class="steps">
              <li data-target="#step1" class="active"><span message key="fk7263.customize.step.1.fishbone"></span><span class="chevron"></span></li>
              <li data-target="#step2"><span message key="fk7263.customize.step.2.fishbone"></span><span class="chevron"></span></li>
            </ul>
          </div>
        </div>
        <p>
          <div class="mi-text" message key="fk7263.customize.step.1.pageingress"></div>
        </p>
      </div>
    </div>

    <br/>

    <div id="customize-certificate" class="certificate" ng-if="viewState.cert != undefined">
      <span class="hide" id="certId" title="{{viewState.cert.id}}"></span>&nbsp;<span class="hide" id="certType" title="fk7263"></span>

      <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
          <div class="cert">
            <div class="cert-titlebar">
              <img class="cert-icon" alt="" ng-src="/web/webjars/fk7263/minaintyg/img/fk7263.png" />

              <div class="row">
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                  <h2 class="cert-title">
                    <span message key="certificatetypes.FK7263.commonname"></span>
                    <span class="cert-titlebar-type">
                      <span class="text-nowrap" message key="certificatetypes.fk7263.typename"></span>
                    </span>
                  </h2>
                </div>
                <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3 issue">
                  <span>Utfärdat:&nbsp;</span>
                  <span class="cert-titlebar-value">{{viewState.cert.grundData.signeringsdatum | date:'shortDate'}}</span>
                </div>
				        <div id="mandatory.8b" class="col-xs-3 col-sm-3 col-md-3 col-lg-3 mandatory">
                  <span class="float-r">
                    <span>Obligatoriskt fält&nbsp;</span><span class="asterix">*</span>
                  </span>
                </div>
              </div>
            </div>

            <div class="cert-header">
              <div class="row">
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 header-row">
                  <h3 class="tag">
                    <span message key="fk7263.label.patientname"></span>
                  </h3>
                  <span id="patient-name">{{viewState.cert.grundData.patient.fullstandigtNamn}}</span><br />
                  <h3 class="tag">
                    <span message key="fk7263.label.civicnumber"></span>
                  </h3>
                  <span id="patient-crn">{{viewState.cert.grundData.patient.personId}}</span>
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                  <h3 class="tag">
                    <span message key="fk7263.label.nedsattning"></span>
                  </h3>

                  <div ng-if="viewState.cert.nedsattMed25 != null" id="nedsattMed25">
                    <span message key="fk7263.nedsattningsgrad.nedsatt_med_1_4"></span><br>
                    <span style="font-weight: normal; font-size: 13px; color: #333">Från och med {{viewState.cert.nedsattMed25.from | date:'longDate'}} &ndash; längst till och med {{viewState.cert.nedsattMed25.tom | date:'longDate'}} </span>
                  </div>

                  <div ng-if="viewState.cert.nedsattMed50 != null" id="nedsattMed50">
                    <span message key="fk7263.nedsattningsgrad.nedsatt_med_1_2"></span><br>
                    <span style="font-weight: normal; font-size: 13px; color: #333">Från och med {{viewState.cert.nedsattMed50.from | date:'longDate'}} &ndash; längst till och med {{viewState.cert.nedsattMed50.tom | date:'longDate'}} </span>
                  </div>

                  <div ng-if="viewState.cert.nedsattMed75 != null" id="nedsattMed75">
                    <span message key="fk7263.nedsattningsgrad.nedsatt_med_3_4"></span><br>
                    <span style="font-weight: normal; font-size: 13px; color: #333">Från och med {{viewState.cert.nedsattMed75.from | date:'longDate'}} &ndash; längst till och med {{viewState.cert.nedsattMed75.tom | date:'longDate'}} </span>
                  </div>

                  <div ng-if="viewState.cert.nedsattMed100 != null" id="nedsattMed100">
                    <span message key="fk7263.nedsattningsgrad.helt_nedsatt"></span><br>
                    <span style="font-weight: normal; font-size: 13px; color: #333">Från och med {{viewState.cert.nedsattMed100.from | date:'longDate'}} &ndash; längst till och med {{viewState.cert.nedsattMed100.tom | date:'longDate'}} </span>
                  </div>

                </div>
              </div>
			        <div class="row border-bottom-resp">
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 header-row">
                  <h3 class="tag">
                    <span message key="fk7263.label.unit"></span>
                  </h3>
                  <span id="careunit">{{viewState.cert.grundData.skapadAv.vardenhet.enhetsnamn}}</span>
                </div>
                <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                  <h3 class="tag">
                    <span message key="fk7263.label.issuer"></span>
                  </h3>
                  <span id="caregiver">{{viewState.cert.grundData.skapadAv.vardenhet.vardgivare.vardgivarnamn}}</span>
                </div>
              </div>
            </div>

            <div class="table-bottom"></div>

            <div class="cert-body">

              <div mi-field-selectable field-number="1" field-label="fk7263.label.smittskydd.anpassatintyg" field-model="viewState.checkboxModel.fields.field1" filled="true" ng-show="showField1()">
                <span ng-show="viewState.cert.avstangningSmittskydd">
                  <span id="smittskydd-yes" message key="fk7263.label.yes"></span>
                </span>
                <span ng-show="!viewState.cert.avstangningSmittskydd">
                  <span id="smittskydd-no" message key="fk7263.label.no"></span>
                </span>
              </div>

              <div mi-field-selectable field-number="2" field-label="fk7263.label.diagnosis.anpassatintyg" field-model="viewState.checkboxModel.fields.field2" filled="viewState.cert.diagnosKod" ng-show="showField2()">
                <div class="form-group">
                  <span class="tag">
                    <span message key="fk7263.label.diagnosisCode"></span>
                  </span>
                  <span id="diagnosKod">{{viewState.cert.diagnosKod}}</span>
                </div>

                <div class="form-group" ng-show="viewState.cert.diagnosBeskrivning">
                  <label class="control-label bold">
                    <span message key="fk7263.label.diagnosfortydligande"></span>
                  </label>
                  <div class="controls">
                    <div id="diagnosBeskrivning" class="multiline">{{viewState.cert.diagnosBeskrivning}}</div>
                  </div>
                </div>
              </div>

              <div mi-field-selectable field-number="3" field-label="fk7263.label.progressofdesease.anpassatintyg" field-model="viewState.checkboxModel.fields.field3" filled="viewState.cert.sjukdomsforlopp!=null" ng-show="showField3()">
                <div id="sjukdomsforlopp" class="multiline">{{viewState.cert.sjukdomsforlopp}}</div>
              </div>

              <div mi-field-selectable field-number="4" field-label="fk7263.label.disabilities.anpassatintyg" field-model="viewState.checkboxModel.fields.field4" filled="viewState.cert.funktionsnedsattning!=null" ng-show="showField4()">
                <div id="funktionsnedsattning" class="multiline">{{viewState.cert.funktionsnedsattning}}</div>
              </div>

              <div mi-field-selectable field-number="4b" field-label="fk7263.label.basedon.anpassatintyg" field-model="viewState.checkboxModel.fields.field4b"
                   filled="viewState.cert.undersokningAvPatienten!=null || viewState.cert.telefonkontaktMedPatienten!=null || viewState.cert.journaluppgifter!=null || viewState.cert.annanReferens!=null"
                   ng-show="showField4b()">
                <div class="tbl">
                  <div id="undersokningAvPatienten" class="tbl-row" ng-show="viewState.cert.undersokningAvPatienten!=null">
                    <div class="tbl-col-l"><span message key="fk7263.vardkontakt.undersokning"></span></div>
                    <div class="tbl-col-r"><span>{{viewState.cert.undersokningAvPatienten | date:'longDate' }}</span></div>
                  </div>
                  <div id="telefonkontaktMedPatienten" class="tbl-row" ng-show="viewState.cert.telefonkontaktMedPatienten!=null">
                    <div class="tbl-col-l"><span message key="fk7263.vardkontakt.telefonkontakt"></div>
                    <div class="tbl-col-r"><span>{{viewState.cert.telefonkontaktMedPatienten | date:'longDate' }}</span></div>
                  </div>
                  <div id="journaluppgifter" class="tbl-row" ng-show="viewState.cert.journaluppgifter!=null">
                    <div class="tbl-col-l"><span message key="fk7263.referens.journal"></span></div>
                    <div class="tbl-col-r"><span>{{viewState.cert.journaluppgifter | date:'longDate' }}</span></div>
                  </div>
                  <div id="annanReferens" class="tbl-row" ng-show="viewState.cert.annanReferens!=null">
                    <div class="tbl-col-l"><span message key="fk7263.referens.annat"></span></div>
                    <div class="tbl-col-r"><span>{{viewState.cert.annanReferens | date:'longDate' }}</span></div>
                  </div>
                </div>
              </div>

              <div mi-field-selectable field-number="5" field-label="fk7263.label.limitation.anpassatintyg" field-model="viewState.checkboxModel.fields.field5" filled="viewState.cert.aktivitetsbegransning!=null" ng-show="showField5()">
                <div id="aktivitetsbegransning-warning" class="alert alert-warning" uib-collapse="viewState.checkboxModel.fields.field5.vald">
                  <span message key="fk7263.customize.message.limitation"></span>
                </div>
                <div id="aktivitetsbegransning" class="multiline">{{viewState.cert.aktivitetsbegransning}}</div>
              </div>

              <div mi-field-selectable field-number="6a" field-label="fk7263.label.recommendations.anpassatintyg.1" field-model="viewState.checkboxModel.fields.field6a1"
                   filled="viewState.cert.rekommendationKontaktArbetsformedlingen || viewState.cert.rekommendationOvrigt != null"
                   ng-show="showField6a1()">

                <div class="tbl">
                  <div id="rekommendationKontaktArbetsformedlingen" class="tbl-row">
                    <div class="tbl-col-l">
                      <span message key="fk7263.label.recommendations.contact.jobcenter"></span>
                    </div>
                    <div class="tbl-col-r">
                      <span ng-if="viewState.cert.rekommendationKontaktArbetsformedlingen">JA</span>
                      <span ng-if="!viewState.cert.rekommendationKontaktArbetsformedlingen">NEJ</span>
                    </div>
                  </div>
                  <div id="rekommendationOvrigt" class="tbl-row">
                    <div class="tbl-col-l">
                      <span message key="fk7263.label.recommendations.contact.other"></span>
                    </div>
                    <div class="tbl-col-r">
                      <span ng-if="viewState.cert.rekommendationOvrigt.length > 0" class="multiline">{{viewState.cert.rekommendationOvrigt}}</span>
                    </div>
                  </div>
                </div>
              </div>

              <div mi-field-selectable field-number="6a" field-label="fk7263.label.recommendations.anpassatintyg.2" field-model="viewState.checkboxModel.fields.field6a2"
                   filled="viewState.cert.rekommendationKontaktForetagshalsovarden" ng-show="showField6a2()">

                <div class="tbl">
                  <div id="rekommendationKontaktForetagshalsovarden" class="tbl-row">
                    <div class="tbl-col-l">
                      <span message key="fk7263.label.recommendations.contact.healthdepartment"></span>
                    </div>
                    <div class="tbl-col-r">
                      <span ng-if="viewState.cert.rekommendationKontaktForetagshalsovarden">JA</span>
                      <span ng-if="!viewState.cert.rekommendationKontaktForetagshalsovarden">NEJ</span>
                    </div>
                  </div>
                </div>
              </div>

              <div mi-field-selectable field-number="6b" field-label="fk7263.label.plannedtreatment.anpassatintyg" field-model="viewState.checkboxModel.fields.field6b"
                   filled="viewState.cert.atgardInomSjukvarden || viewState.cert.annanAtgard"
                   ng-show="showField6b()">

                <div class="tbl">
                  <div id="atgardSjukvard" class="tbl-row" ng-show="viewState.cert.atgardInomSjukvarden != null">
                    <div class="tbl-col-l"><span message key="fk7263.label.plannedtreatment.healthcare"></span></div>
                    <div class="tbl-col-r multiline">{{viewState.cert.atgardInomSjukvarden}}</div>
                  </div>
                  <div id="atgardAnnan" class="tbl-row" ng-show="viewState.cert.annanAtgard != null">
                    <div class="tbl-col-l"><span message key="fk7263.label.plannedtreatment.other"></span></div>
                    <div class="tbl-col-r multiline">{{viewState.cert.annanAtgard}}</div>
                  </div>
                </div>
              </div>

              <div mi-field-selectable field-number="7" field-label="fk7263.label.workrehab.anpassatintyg" field-model="viewState.checkboxModel.fields.field7" filled="viewState.cert.rehabilitering" ng-show="showField7()">
                <span ng-show="viewState.cert.rehabilitering == 'rehabiliteringAktuell'">
                  <span id="rehabilitering-yes" message key="fk7263.label.yes"></span>
                </span>
                <span ng-show="viewState.cert.rehabilitering == 'rehabiliteringEjAktuell'">
                  <span id="rehabilitering-no" message key="fk7263.label.no"></span>
                </span>
                <span ng-show="viewState.cert.rehabilitering == 'rehabiliteringGarInteAttBedoma'">
                  <span id="rehabilitering-unjudgeable" message key="fk7263.label.unjudgeable"></span>
                </span>
              </div>

              <div mi-field-selectable field-number="8a" field-label="fk7263.label.patientworkcapacity.anpassatintyg.1" field-model="viewState.checkboxModel.fields.field8a1"
                   filled="viewState.cert.arbetsloshet || viewState.cert.foraldrarledighet" ng-show="showField8a1()">

                <div class="tbl">
                  <div id="arbetslos" class="tbl-row" ng-show="viewState.cert.arbetsloshet">
                    <div class="tbl-col-l"><span message key="fk7263.label.patientworkcapacity.unemployed"></span></div>
                  </div>
                  <div id="foraldraledig" class="tbl-row" ng-show="viewState.cert.foraldrarledighet">
                    <div class="tbl-col-l"><span message key="fk7263.label.patientworkcapacity.parentalleave"></span></div>
                  </div>
                </div>
              </div>

              <div mi-field-selectable field-number="8a" field-label="fk7263.label.patientworkcapacity.anpassatintyg.2" field-model="viewState.checkboxModel.fields.field8a2"
                   filled="viewState.cert.nuvarandeArbetsuppgifter" ng-show="showField8a2()">

                <div class="tbl">
                  <div id="nuvarandeArbetsuppgifter" class="tbl-row" ng-show="viewState.cert.nuvarandeArbetsuppgifter">
                    <div class="tbl-col-l"><span message key="fk7263.label.patientworkcapacity.currentwork"></span></div>
                    <div class="tbl-col-r multiline">{{viewState.cert.nuvarandeArbetsuppgifter}}</div>
                  </div>
                </div>
              </div>

              <div mi-field-selectable field-number="9" field-label="fk7263.label.patientworkcapacityjudgement.anpassatintyg" field-model="viewState.checkboxModel.fields.field9"
                   filled="viewState.cert.arbetsformagaPrognos != null" ng-show="showField9()">

                <div id="arbetsformagaPrognos" class="multiline">{{viewState.cert.arbetsformagaPrognos}}</div>
              </div>

              <div mi-field-selectable field-number="10" field-label="fk7263.label.prognosis.anpassatintyg" field-model="viewState.checkboxModel.fields.field10"
                   filled="viewState.cert.prognosBedomning" ng-show="showField10()">

                <span ng-show="viewState.cert.prognosBedomning == 'arbetsformagaPrognosJa'">
                  <span id="arbetsformagaPrognos-yes" message key="fk7263.label.yes"></span>
                </span>
                <span ng-show="viewState.cert.prognosBedomning == 'arbetsformagaPrognosJaDelvis'">
                  <span id="arbetsformagaPrognos-partialyes" message key="fk7263.label.partialyes"></span>
                </span>
                <span ng-show="viewState.cert.prognosBedomning == 'arbetsformagaPrognosNej'">
                  <span id="arbetsformagaPrognos-no" message key="fk7263.label.no"></span>
                </span>
                <span ng-show="viewState.cert.prognosBedomning == 'arbetsformagaPrognosGarInteAttBedoma'">
                  <span id="arbetsformagaPrognos-unjudgeable" message key="fk7263.label.unjudgeable"></span>
                </span>
              </div>

              <div mi-field-selectable field-number="11" field-label="fk7263.label.othertransport.anpassatintyg" field-model="viewState.checkboxModel.fields.field11"
                   filled="viewState.cert.ressattTillArbeteAktuellt || viewState.cert.ressattTillArbeteEjAktuellt"
                   ng-show="showField11()">

                <span ng-show="viewState.cert.ressattTillArbeteAktuellt">
                  <span id="resaTillArbetet-yes" message key="fk7263.label.yes"></span>
                </span>
                <span ng-show="viewState.cert.ressattTillArbeteEjAktuellt">
                  <span id="resaTillArbetet-no" message key="fk7263.label.no"></span>
                </span>
              </div>

              <div mi-field-selectable field-number="12" field-label="fk7263.label.fkcontact.anpassatintyg" field-model="viewState.checkboxModel.fields.field12" filled="true" ng-show="showField12()">
                <span ng-show="viewState.cert.kontaktMedFk">
                  <span id="kontaktFk-yes" message key="fk7263.label.yes"></span>
                </span>
                <span ng-show="!viewState.cert.kontaktMedFk">
                  <span id="kontaktFk-no" message key="fk7263.label.no"></span>
                </span>
              </div>

              <div mi-field-selectable field-number="13" field-label="fk7263.label.otherinformation.anpassatintyg" field-model="viewState.checkboxModel.fields.field13" filled="viewState.cert.kommentar" ng-show="showField13()">
                <!--  leave  as div tag for IE8 magic bug. using span crashes angular.. -->
                <div id="kommentar" class="tag multiline" ng-show="viewState.cert.kommentar.length > 0">{{viewState.cert.kommentar}}</div>
              </div>

              <div class="col-xs-12 col-sm-8 col-md-8 col-lg-8">
                <p>
                  <button type="button" id="confirmCertificateCustomizationBtn" type="button" ng-click="confirmCertificateCustomization()" class="btn btn-success">
                    <span message key="fk7263.button.next"></span>
                  </button>
                  <button type="button" id="cancelCertificateCustomizationBtn" ng-click="backToViewCertificate()" class="btn btn-default">
                    <span message key="fk7263.button.cancel"></span>
                  </button>
                </p>
              </div>

            </div>
            <!-- cert-body -->

          </div>
        </div>
      </div>

    </div>
  </div>
  <!-- eof spinner -->
</div>
