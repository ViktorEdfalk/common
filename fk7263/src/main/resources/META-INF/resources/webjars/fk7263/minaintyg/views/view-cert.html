<mi-page-head>
  <mi-breadcrumb></mi-breadcrumb>

  <!-- Content -->
  <div class="row">
    <div class="col-xs-12 col-sm-7">
      <h1 ng-focus="pagefocus" tabindex="-1">
        <span id="viewCertificateHeader" message key="fk7263.label.pagetitle"></span>
      </h1>
      <div>
        <span class="mi-text" message key="fk7263.label.pageingress"></span>
      </div>

      <div uib-collapse="!isCollapsed1" class="collapse">
        <h3>
          <span message key="fk7263.label.pagedescription.sendcertificate.header"></span>
        </h3>
        <span message key="fk7263.label.pagedescription.sendcertificate"></span>

        <h3>
          <span message key="fk7263.label.pagedescription.save.or.print.certificate.header"></span>
        </h3>
        <span message key="fk7263.label.pagedescription.save.or.print.certificate"></span>
        <a class="glyphicon glyphicon-question-sign more-info" ng-click="isCollapsedPDF = !isCollapsedPDF"
           title="{{messageService.getProperty('common.title.helptext.moreinfo')}}"></a>
        <div uib-collapse="!isCollapsedPDF" class="well well-sm margin-top-5px">
          <span message key="fk7263.helptext.readpdfhelp"></span>
        </div>

        <h3>
          <span message key="fk7263.label.pagedescription.sickness.benefit.header"></span>
        </h3>
        <span message key="fk7263.label.pagedescription.sickness.benefit"></span>

        <h3>
          <span message key="fk7263.label.pagedescription.error.in.certificate.header"></span>
        </h3>
        <span message key="fk7263.label.pagedescription.error.in.certificate"></span>

        <h3>
          <span message key="fk7263.label.pagedescription.archive.header"></span>
        </h3>
        <span message key="fk7263.label.pagedescription.archive"></span>
      </div>

      <button type="button" ng-click="isCollapsed1 = !isCollapsed1" class="btn-link btn-link-link margin-top-5px"
              data-toggle="collapse">
        <span message key="fk7263.label.status.{{!isCollapsed1}}"></span>
      </button>
    </div>

    <div class="col-xs-12 col-sm-5">
      <latest-events cert-id="{{cert.id}}" statuses="certMeta.statuses"></latest-events>
    </div>
  </div>
</mi-page-head>

<div class="container">
  <div class="row-fluid">

    <div mi-spinner label="fk7263.message.certificateloading" show-spinner="!doneLoading" show-content="doneLoading">

      <mi-certificate-action-buttons
          cert-model="cert"
          on-send="send(cert)"
          enable-archive="true"
          enable-print="true"
          on-customize-pdf="customizeCertificate()">

      </mi-certificate-action-buttons>

      <mi-compact-certificate-header cert-meta-model="certMeta"></mi-compact-certificate-header>
      <mi-compact-certificate-body cert-meta-model="certMeta"></mi-compact-certificate-body>
      <uv-render-components config="uvConfig" view-data="cert"></uv-render-components>

      <div class="row col-xs-12 text-muted"><br><span message key="modules.view-intyg.end-of-intyg.text"></span></div>
    </div>
    <!-- eof spinner -->
  </div>
</div>

<div class="container">
  <div class="row-fluid">

    <div mi-spinner label="fk7263.message.certificateloading" show-spinner="!doneLoading" show-content="doneLoading">

      <div id="certificate" class="certificate">
        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="cert">
              <div class="cert-header">
                <div class="row">
                  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 header-row">
                    <h3 class="tag">
                      <span message key="fk7263.label.patientname"></span>
                    </h3>
                    <span id="patient-name">{{cert.grundData.patient.fullstandigtNamn}}</span><br />
                    <h3 class="tag">
                      <span message key="fk7263.label.civicnumber"></span>
                    </h3>
                    <span id="patient-crn">{{cert.grundData.patient.personId}}</span>
                  </div>
                  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    <h3 class="tag">
                      <span message key="fk7263.label.nedsattning"></span>
                    </h3>

                    <div ng-if="cert.nedsattMed25 != null" id="nedsattMed25">
                      <span message key="fk7263.nedsattningsgrad.nedsatt_med_1_4"></span><br>
                      <span style="font-weight: normal; font-size: 13px; color: #333">Från och med {{cert.nedsattMed25.from | date:'longDate'}} &ndash;
                        längst till och med {{cert.nedsattMed25.tom | date:'longDate'}} </span>
                    </div>

                    <div ng-if="cert.nedsattMed50 != null" id="nedsattMed50">
                      <span message key="fk7263.nedsattningsgrad.nedsatt_med_1_2"></span><br>
                      <span style="font-weight: normal; font-size: 13px; color: #333">Från och med {{cert.nedsattMed50.from | date:'longDate'}} &ndash;
                        längst till och med {{cert.nedsattMed50.tom | date:'longDate'}} </span>
                    </div>

                    <div ng-if="cert.nedsattMed75 != null" id="nedsattMed75">
                      <span message key="fk7263.nedsattningsgrad.nedsatt_med_3_4"></span><br>
                      <span style="font-weight: normal; font-size: 13px; color: #333">Från och med {{cert.nedsattMed75.from | date:'longDate'}} &ndash;
                        längst till och med {{cert.nedsattMed75.tom | date:'longDate'}} </span>
                    </div>

                    <div ng-if="cert.nedsattMed100 != null" id="nedsattMed100">
                      <span message key="fk7263.nedsattningsgrad.helt_nedsatt"></span><br>
                      <span style="font-weight: normal; font-size: 13px; color: #333">Från och med {{cert.nedsattMed100.from | date:'longDate'}} &ndash;
                        längst till och med {{cert.nedsattMed100.tom | date:'longDate'}} </span>
                    </div>

                  </div>
                </div>
              </div>

              <div class="intyg-body">

                <div mi-field field-label="fk7263.label.othertransport"
                     filled="cert.ressattTillArbeteAktuellt || cert.ressattTillArbeteEjAktuellt">
                <span ng-show="cert.ressattTillArbeteAktuellt">
                  <span id="resaTillArbetet-yes" message key="fk7263.label.yes"></span>
                </span>
                  <span ng-show="cert.ressattTillArbeteEjAktuellt">
                  <span id="resaTillArbetet-no" message key="fk7263.label.no"></span>
                </span>
                </div>

              </div>
              <!-- intyg-body -->

            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- eof spinner -->
  </div>
</div>
