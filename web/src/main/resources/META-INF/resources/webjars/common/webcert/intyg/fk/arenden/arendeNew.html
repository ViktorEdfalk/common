<!-- Question button -->
<div ng-show="!certProperties.kompletteringOnly && !certProperties.isRevoked && !widgetState.newQuestionOpen && (viewState.isIntygOnSendQueue || certProperties.isSent || qaList.length>0)"
     wc-check-vardenhet vardenhet="{{cert.grundData.skapadAv.vardenhet.enhetsid}}">
  <div class="form-group">
    <button type="button" class="btn btn-success" ng-click="toggleQuestionForm()" id="askQuestionBtn">Ny fråga till
      Försäkringskassan
    </button>
  </div>
</div>
<div ng-if="viewState.isIntygOnSendQueue === false && certProperties.isSent === false && (qaList.length<1)" wc-check-vardenhet
     vardenhet="{{cert.grundData.skapadAv.vardenhet.enhetsid}}" class="alert alert-info"
     id="certificate-is-not-sent-to-fk-message-text">
  <strong>Intyget är inte skickat till Försäkringskassan.</strong><br> Det går därför inte att ställa frågor om
  intyget.
</div>
<div ng-if="certProperties.isSent === undefined && (qaList.length<1)" wc-check-vardenhet
     vardenhet="{{cert.grundData.skapadAv.vardenhet.enhetsid}}" class="alert alert-info"
     id="certificate-is-not-available">
  <strong>Det finns inga frågor och svar.</strong>
</div>

<!-- New question form -->
<div ng-show="widgetState.newQuestionOpen">
  <div class="form-group">
    <div class="alert alert-info">
      Här kan du föra en dialog med Försäkringskassan om ett intyg. Medicinsk information ska endast skickas via signerade intyg.
    </div>
  </div>
  <div class="form-group">
    <label class="control-label">Fråga</label>
    <textarea wc-maxlength ng-trim="false" maxlength="2000" rows="13" class="form-control"
              ng-model="newQuestion.frageText" wc-focus-me="widgetState.focusQuestion"
              id="newQuestionText"></textarea>
  </div>
  <div class="form-group" id="newQuestionForm">
    <label class="control-label">Ämne</label>
    <div class="controls">
      <select id="new-question-topic" class="form-control" ng-model="newQuestion.chosenTopic"
              ng-options="c.label for c in newQuestion.topics track by c.value"></select>
    </div>
  </div>

  <!-- error message occuring when inteacting with server for this FragaSvar-->
  <div id="newQuestion-load-error" ng-show="newQuestion.activeErrorMessageKey" class="alert alert-danger">
    <span message key="fk7263.error.{{newQuestion.activeErrorMessageKey}}"></span>
  </div>

  <!-- Form button group -->
  <div class="form-group">
    <button type="button" class="btn btn-success" ng-click="sendQuestion(newQuestion)"
            ng-disabled="!questionValidForSubmit(newQuestion)" title="{{newQuestion.sendButtonToolTip}}"
            id="sendQuestionBtn">
      <img src="/img/loader-small-green.gif" ng-show="newQuestion.updateInProgress"> Skicka till
      Försäkringskassan
    </button>
    <button type="button" class="btn btn-default btn-secondary" ng-click="toggleQuestionForm()" id="cancelQuestionBtn">Avbryt
      fråga
    </button>
  </div>
</div>
<!--  Arende formular end -->

<!-- question sent message -->
<div ng-if="widgetState.sentMessage">
  <div alert type="info" close="dismissSentMessage()" id="question-is-sent-to-fk-message-text">
    <strong>Frågan är skickad till Försäkringskassan</strong><br><span wc-authority="HANTERA_MAILSVAR"> Vårdenheten kontaktas via mejl när svar har inkommit.</span>
  </div>
</div>

<!-- error message -->
<div id="arende-list-load-error" ng-show="viewState.doneLoading && viewState.activeErrorMessageKey"
     class="alert alert-danger">
  <span message key="common.fk.fragasvar.error.{{viewState.activeErrorMessageKey}}"></span>
</div>
