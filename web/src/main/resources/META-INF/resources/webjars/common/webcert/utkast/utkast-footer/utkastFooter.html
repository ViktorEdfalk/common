<div id="utkast-footer">
  <div ng-if="!isSigned" class="utkast-footer">

    <!-- Läkare: Signera -->
    <div wc-authority="SIGNERA_INTYG" intygstyp="{{viewState.common.intyg.type}}">
      <p ng-show="viewState.common.intyg.isKomplettering">
        <span message key="draft.completion.signinfo"></span>
      </p>
      <button type="button" id="signera-utkast-button" class="btn btn-success"
              ng-disabled="certForm.$dirty || signingWithSITHSInProgress"
              ng-keydown="initValidationSequence('signera-utkast-button')"
              ng-mousedown="initValidationSequence('signera-utkast-button')"
              ng-click="sign()"><img ng-show="signingWithSITHSInProgress" ng-src="/img/ajax-loader-small-green.gif" />
        <span message key="common.{{isSignAndSend() ? 'signsend' : 'sign'}}"></span>
      </button>

      <!-- Om personen har loggat in med BANK ID skall vi visa en liten extra text -->
      <p ng-if="user.authenticationMethod === 'BANK_ID'">
        <span message key="common.modal.label.signing.open.bankid"></span>
      </p>
    </div>

    <!-- Vårdadmin -->
    <div wc-authority="!SIGNERA_INTYG">

      <!-- Signera intyg -->
      <h3 >
        <span message key="common.sign.intyg"></span>
      </h3>

      <!-- Endast läkare får signera -->
      <div id="sign-requires-doctor-message-text"
           intygstyp="{{viewState.common.intyg.type}}"
           class="alert alert-info">
        <span message key="draft.onlydoctorscansign"></span>
      </div>

      <!-- check for missing info in utkast -->
      <div class="form-group">
        <button type="button" id="show-missing-btn" class="btn btn-success"
                ng-keydown="initValidationSequence('show-missing-btn')"
                ng-mousedown="initValidationSequence('show-missing-btn')"
                ng-click="checkMissing()"
                ng-disabled="viewState.common.intyg.isComplete">
          <span message key="draft.notify.check-missing"></span>
        </button>
        <span wc-help-chevron help-text-key="draft.notify.check-missing.help"></span>
        <span wc-help-chevron-text help-text-key="draft.notify.check-missing.help"></span>
      </div>



      <!-- Vårdadmin kan notifiera via statusuppdatering för SMI-intyg -->
      <div wc-authority="NOTIFIERING_UTKAST" intygstyp="{{viewState.common.intyg.type}}">
        <button ng-if="!viewState.klartForSigneringDatum" type="button" id="markeraKlartForSigneringButton" class="btn btn-success" ng-click="notifieraUtkast()">
          <span message key="draft.notifyready.button"></span>
        </button>
        <div ng-if="viewState.klartForSigneringDatum">
          <span class="glyphicon glyphicon-check ng-scope"></span>
          <span id="draft-marked-ready-text" message key="draft.notifyready.text"></span>
        </div>
      </div>



      <!-- Notifiera läkare genom att vidarebefordra -->
      <div wc-authority="VIDAREBEFORDRA_UTKAST" intygstyp="{{viewState.common.intyg.type}}">
        <div class="form-group">
          <button type="button" id="vidarebefordraEjHanterad" class="btn"
                  ng-class="{'btn-success': !viewState.draftModel.vidarebefordrad, 'btn-secondary' : viewState.draftModel.vidarebefordrad}"
                  ng-click="vidarebefordraUtkast()"><span class="glyphicon glyphicon-share-alt"
                ng-class="{'forward-active': !viewState.draftModel.vidarebefordrad, 'forward-inactive': viewState.draftModel.vidarebefordrad}"></span>
             <span message key="draft.notify.button"></span>
          </button>
          <span wc-help-chevron help-text-key="draft.notify.help"></span>
          <span wc-help-chevron-text help-text-key="draft.notify.help"></span>
        </div>

        <div class="intyg-block">
          <label for="mark-as-vidarebefordrad">
            <input id="mark-as-vidarebefordrad" type="checkbox" ng-disabled="viewState.common.vidarebefordraInProgress"
                   ng-model="viewState.draftModel.vidarebefordrad" ng-change="onVidarebefordradChange()" />
            Vidarebefordrad
          </label> <span ng-if="viewState.common.vidarebefordraInProgress"> <img
            src="/img/ajax-loader-kit-16x16.gif"></span>
        </div>
      </div>
    </div>

  </div>
  <a id="bottom"></a>
</div>
