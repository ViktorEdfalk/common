<!-- Question button -->
<div ng-show="!intygProperties.kompletteringOnly && !intygProperties.isRevoked && !viewState.arendeNewOpen && (viewState.isIntygOnSendQueue || intygProperties.isSent || arendeList.length>0)"
     wc-check-vardenhet
     vardenhet="{{intyg.grundData.skapadAv.vardenhet.enhetsid}}">
  <div class="form-group">
    <button type="button" class="btn btn-success" ng-click="toggleQuestionForm()" id="askQuestionBtn">Ny fråga till
      Försäkringskassan
    </button>
  </div>
</div>
<div ng-if="viewState.isIntygOnSendQueue === false && intygProperties.isSent === false && (arendeList.length<1)"
     wc-check-vardenhet
     vardenhet="{{intyg.grundData.skapadAv.vardenhet.enhetsid}}" class="alert alert-info"
     id="intyg-is-not-sent-to-fk-message-text">
  <strong>Intyget är inte skickat till Försäkringskassan.</strong><br> Det går därför inte att ställa frågor om
  intyget.
</div>
<div ng-if="intygProperties.isSent === undefined && (arendeList.length<1)"
     wc-check-vardenhet
     vardenhet="{{intyg.grundData.skapadAv.vardenhet.enhetsid}}" class="alert alert-info"
     id="intyg-is-not-available">
  <strong>Det finns inga frågor och svar.</strong>
</div>

<!-- New question form -->
<div ng-show="viewState.arendeNewOpen">
  <div class="form-group">
    <div class="alert alert-info">
      Här kan du föra en dialog med Försäkringskassan om ett intyg. Medicinsk information ska endast skickas via signerade intyg.
    </div>
  </div>
  <div class="form-group">
    <label class="control-label">Fråga</label>
    <textarea wc-maxlength ng-trim="false" maxlength="2000" rows="13" class="form-control"
              ng-model="arendeNewModel.frageText" wc-focus-me="viewState.focusQuestion"
              id="arendeNewModelText"></textarea>
  </div>
  <div class="form-group" id="arendeNewModelForm">
    <label class="control-label">Ämne</label>
    <div class="controls">
      <select id="new-question-topic" class="form-control" ng-model="arendeNewModel.chosenTopic"
              ng-options="c.label for c in arendeNewModel.topics track by c.value"></select>
    </div>
  </div>

  <!-- error message occuring when inteacting with server for this FragaSvar-->
  <div id="arendeNewModel-load-error" ng-show="arendeNewModel.activeErrorMessageKey" class="alert alert-danger">
    <span message key="common.arende.error.{{arendeNewModel.activeErrorMessageKey}}"></span>
  </div>

  <!-- Form button group -->
  <div class="form-group">
    <button type="button" class="btn btn-success" ng-click="sendQuestion(arendeNewModel)"
            ng-disabled="!questionValidForSubmit(arendeNewModel)" title="{{arendeNewModel.sendButtonToolTip}}"
            id="sendQuestionBtn">
      <img src="/img/loader-small-green.gif" ng-show="arendeNewModel.updateInProgress"> Skicka till
      Försäkringskassan
    </button>
    <button type="button" class="btn btn-default btn-secondary" ng-click="toggleQuestionForm()" id="cancelQuestionBtn">Avbryt
      fråga
    </button>
  </div>
</div>
<!--  Arende formular end -->

<!-- question sent message -->
<div ng-if="viewState.sentMessage">
  <div alert type="info" close="dismissSentMessage()" id="question-is-sent-to-fk-message-text">
    <strong>Frågan är skickad till Försäkringskassan</strong><br><span wc-authority="HANTERA_MAILSVAR"> Vårdenheten kontaktas via mejl när svar har inkommit.</span>
  </div>
</div>

<!-- error message -->
<div id="arende-list-load-error" ng-show="viewState.doneLoading && viewState.activeErrorMessageKey"
     class="alert alert-danger">
  <span message key="common.fk.fragasvar.error.{{viewState.activeErrorMessageKey}}"></span>
</div>
