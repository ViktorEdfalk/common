<!--

    Copyright (C) 2013 Inera AB (http://www.inera.se)

    This file is part of Inera Certificate Modules (http://code.google.com/p/inera-certificate-modules).

    Inera Certificate Modules is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    Inera Certificate Modules is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

-->
<div class="row-fluid">

  <!-- Loading spinner: visibility defined by $scope.doneLoading  -->
  <div ng-hide="doneLoading" style="text-align: center; padding: 20px;">
    <img src="/img/ajax-loader.gif" style="text-align: center;" />
    <p style="text-align: center; color: #64ABC0; margin-top: 20px;">
      <strong><message key="view.message.certificateloading" /></strong>
    </p>
  </div>

  <div ng-show="doneLoading">
  
    <div id="backnav" class="row-fluid">
      <a class="backlink" href="/web/start"><message key="button.goback" /></a>
    </div>



<!--     Content -->

    <div class="row-fluid">
      <div class="span7">
        <h1>
          <message key="view.label.pagetitle" />
        </h1>
        <p>
          <message key="view.label.pagedescription" />
        </p>
        <form id="view-as-pdf" action="{{downloadAsPdfLink}}" method="get" target="_blank" name="pdfForm">
          <p class="btn-row">
            <button type="button" ng-click="open()" class="btn btn-success">
              <message key="button.send" />
            </button>
            <button id="downloadprint" type="submit" onClick="document.pdfForm.submit()" class="btn btn-inverse">
              <message key="button.downloadprint" />
            </button>
          </p>
        </form>
      </div>
      <div class="span5 eventbox">
        <h2>
          <span message key="view.label.latestevent"></span>
        </h2>
<!--          Show if no events to show -->
        <p ng-show="!cert.status">
          <span message key="view.label.latestevent.noevents"></span></a>
        </p>

<!--         Show first status in list if any viable status exist -->
        <p id="lastest-certificate-event" ng-show="cert.status.length>0">
          {{cert.status[0].timestamp | date:'shortDate'}} <span message key="ts-bas.status.{{cert.status[0].type}}"></span> <span message
            key="ts-bas.target.{{cert.status[0].target}}"></span>
        </p>
<!--         Show if more than 1 viable status exists -->
        <p ng-show="cert.status.length>1">
          <a class="statusHistoryLink" href ng-click="showStatusHistory()"><span message key="view.label.latestevent.showall"></span></a>
        </p>
      </div>
    </div>
    <section id="certificate" class="certificate">
      <span class="hide" id="certId" title="{{cert.id}}"></span> <span class="hide" id="certType" title="{{cert.typ}}"></span>
      <div class="row-fluid">
        <div class="span12">
          <div class="cert">
            <div class="cert-titlebar">
              <div class="row-fluid">
                <div class="span6">
                  <h2>
                    <span><message key="view.label.certtitle" /></span>
                  </h2>
                </div>
                <div class="span5 issue">
                  <span><message key="view.label.issued" /></span> <span class="cert-titlebar-value">{{cert.signeringsdatum | date:'longDate'}}</span>
                </div>
                <div class="span1 archive">
                  <a href="#archiveModal" role="button" data-toggle="modal" onclick="return false"><img alt="Arkivera intyg" src="/img/archive-icon.gif" /></a>
                </div>
              </div>
            </div>
            <div class="cert-header">
              <div class="row-fluid">
                <div class="span6">
                  <span class="tag"><message key="view.label.patientname" /></span> <span id="patient-name">{{cert.patient.fullstandigtNamn}}</span>
                </div>
                <div class="span6">
                  <span class="tag"><message key="view.label.unit" /></span> <span id="careunit">{{cert.skapadAv.vardenhet.enhetsnamn}}</span>
                </div>
              </div>
              <div class="row-fluid">
                <div class="span6">
                  <span class="tag"><message key="view.label.civicnumber" /></span> <span id="patient-crn">{{cert.patient.personid}}</span>
                </div>
                <div class="span6">
                  <span class="tag"><message key="view.label.issuer" /></span> <span id="caregiver">{{cert.skapadAv.vardenhet.vardgivare.vardgivarnamn}}</span>
                </div>
              </div>
             
            </div>
            <div class="cert-body">
                  <div class="body-row">
                    {{cert}}
                  </div>
	              <div class="body-row">
	              	<h3>Utf채rdare</h3>
	              	<span class="title">L채kare</span> <span id="physician-name-id" class="text">{{cert.skapadAv.fullstandigtNamn}} ({{cert.skapadAv.personid}})</span><br/>
	              	<span class="title">V책rdgivare</span> <span id="caregiver-name-id" class="text">{{cert.skapadAv.vardenhet.vardgivare.vardgivarnamn}} ({{cert.skapadAv.vardenhet.vardgivare.vardgivarid}})</span><br/>
	                <span class="title">V책rdenhetens namn och id</span> <span id="careunit-name-id" class="text">{{cert.skapadAv.vardenhet.enhetsnamn}} ({{cert.skapadAv.vardenhet.enhetsid}})</span><br/>
	                <span class="title">Postadress</span> <span id="careunit-postal_address" class="text">{{cert.skapadAv.vardenhet.postadress}}, {{cert.skapadAv.vardenhet.postnummer}} {{cert.skapadAv.vardenhet.postort}}</span>
	              </div>

            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

</div>
