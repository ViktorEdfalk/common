<mi-page-head>
  <mi-breadcrumb></mi-breadcrumb>

  <!-- page head content -->
  <div class="row">
    <div class="col-xs-12 col-sm-7">
      <h1 ng-focus="pagefocus" tabindex="-1">
        <span id="viewCertificateHeader">Läs och hantera ditt intyg</span>
      </h1>
      <div>
        Här visas hela ditt läkarintyg. Från den här sidan kan du skicka intyget, göra en anpassad version till din
        arbetsgivare, ladda ner intyget som PDF och arkivera intyget. Om du vill ansöka om sjukpenning, gör du det
        enklast
        på <a href="http://www.forsakringskassan.se/sjuk" target="_blank">www.forsakringskassan.se/sjuk</a>. För
        medicinska frågor som rör ditt intyg ska du kontakta den som utfärdade ditt intyg, eller den mottagning du
        besökte
        när du fick ditt intyg utfärdat.
      </div>

      <div uib-collapse="!isCollapsed1" class="collapse">
        <span message key="modules.page-header.info.select-recipients-and-send"></span>
        <span message key="modules.page-header.info.customize-pdf"></span>
        <span message key="modules.page-header.info.download-pdf"></span>
        <span message key="modules.page-header.info.archive"></span>
      </div>

      <button type="button" ng-click="isCollapsed1 = !isCollapsed1" class="btn-link btn-link-link margin-top-5px"
              data-toggle="collapse">
        <span message key="lisjp.label.status.{{!isCollapsed1}}"></span>
      </button>
    </div>

    <div class="col-xs-12 col-sm-5">
      <latest-events cert-id="{{cert.id}}" statuses="cert.filteredStatuses"></latest-events>
    </div>
  </div>

</mi-page-head>


<div class="container">
  <div class="row-fluid">

    <div mi-spinner label="lisjp.message.certificateloading" show-spinner="!doneLoading" show-content="doneLoading">

      <mi-certificate-action-buttons
          cert-model="cert"
          on-send="send(cert)"
          enable-archive="true"
          enable-print="true"
          on-customize-pdf="customizeCertificate()">

      </mi-certificate-action-buttons>

      <mi-compact-certificate-header cert-meta-model="certMeta"></mi-compact-certificate-header>
      <mi-compact-certificate-body cert-meta-model="certMeta"></mi-compact-certificate-body>
      <uv-render-components config="uvConfig" view-data="viewData"></uv-render-components>


      <div id="certificate" class="certificate">
        <span class="hide" id="certId" title="{{cert.id}}"></span>
        <span class="hide" id="certType" title="{{cert.typ}}"></span>


        <div class="row">
          <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <div class="cert">
              <div class="cert-titlebar">
                <img class="cert-icon" alt="" ng-src="/web/webjars/lisjp/minaintyg/img/lisjp.png" />

                <div class="row">
                  <div class="col-xs-6 col-sm-7 col-md-8 col-lg-8">
                    <h2 class="cert-title">
                      LISJP temp </h2>
                  </div>
                  <div class="col-xs-6 col-sm-5 col-md-4 col-lg-4 issue text-right">
                  <span class="cert-titlebar-value">
                    <span message key="lisjp.label.issued"></span>
                  </span>
                    <span class="cert-titlebar-value">{{cert.grundData.signeringsdatum | date:'shortDate'}}</span>
                  </div>
                </div>
              </div>

              <div class="cert-header">
                <div class="row">
                  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 header-row">
                    <h3 class="tag">
                      <span message key="lisjp.label.patientname"></span>
                    </h3>
                    <span
                        id="patient-name">{{cert.grundData.patient.fornamn}} {{ cert.grundData.patient.efternamn }}</span><br />
                    <h3 class="tag">
                      <span message key="lisjp.label.civicnumber"></span>
                    </h3>
                    <span id="patient-crn">{{cert.grundData.patient.personId}}</span>
                  </div>
                  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    <!--h3 class="tag">
                      <span message key="lisjp.label.nedsattning"></span>
                    </h3-->
                  </div>
                </div>
                <div class="row border-bottom-resp">
                  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 header-row">
                    <h3 class="tag">
                      <span message key="lisjp.label.unit"></span>
                    </h3>
                    <span id="careunit">{{cert.grundData.skapadAv.vardenhet.enhetsnamn}}</span>
                  </div>
                  <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6">
                    <h3 class="tag">
                      <span message key="lisjp.label.issuer"></span>
                    </h3>
                    <span id="caregiver">{{cert.grundData.skapadAv.vardenhet.vardgivare.vardgivarnamn}}</span>
                  </div>
                </div>
              </div>

              <div class="intyg-body">

                <!-- Smittbärarpenning-->
                <category-wrapper category-key="10" intyg-model="cert">
                  <div mi-category category-label="KAT_10.RBK">
                    <div mi-field field-dynamic-label="FRG_27" filled="true">
                    <span ng-show="cert.avstangningSmittskydd">
                      <span id="avstangningsmittskydd-yes" message key="lisjp.label.yes"></span>
                    </span>
                      <span ng-show="!cert.avstangningSmittskydd">
                      <span id="avstangningsmittskydd-no" message key="lisjp.label.no"></span>
                    </span>
                    </div>
                  </div>
                </category-wrapper>

                <!-- Grund för medicinskt underlag -->
                <category-wrapper category-key="1" intyg-model="cert">
                  <div mi-category category-label="KAT_1.RBK">
                    <div mi-field field-dynamic-label="FRG_1"
                         filled="cert.undersokningAvPatienten!=null || cert.telefonkontaktMedPatienten!=null || cert.journaluppgifter!=null || cert.annatGrundForMU!=null">
                      <ul class="padded-list">
                        <li ng-show="cert.undersokningAvPatienten!=null">
                          <div id="undersokningAvPatienten">
                            <span dynamic-label key="KV_FKMU_0001.UNDERSOKNING.RBK"></span><span> | {{cert.undersokningAvPatienten | date:'longDate' }}</span>
                          </div>
                        </li>
                        <li ng-show="cert.telefonkontaktMedPatienten !=null">
                          <div id="telefonkontaktMedPatienten">
                            <span dynamic-label key="KV_FKMU_0001.TELEFONKONTAKT.RBK"></span><span> | {{cert.telefonkontaktMedPatienten | date:'longDate' }}</span>
                          </div>
                        </li>
                        <li ng-show="cert.journaluppgifter!=null">
                          <div id="journaluppgifter">
                            <span dynamic-label key="KV_FKMU_0001.JOURNALUPPGIFTER.RBK"></span><span> | {{cert.journaluppgifter | date:'longDate' }}</span>
                          </div>
                        </li>
                        <li ng-show="cert.annatGrundForMU!=null">
                          <div id="annatGrundForMU">
                            <span dynamic-label key="KV_FKMU_0001.ANNAT.RBK"></span><span> | {{cert.annatGrundForMU | date:'longDate' }}</span>
                          </div>
                        </li>
                        <span dynamic-label key="DFR_1.3.RBK" ng-show="cert.annatGrundForMUBeskrivning!=null"></span>
                        <div ng-show="cert.annatGrundForMUBeskrivning!=null">
                          {{cert.annatGrundForMUBeskrivning}}
                        </div>
                      </ul>
                    </div>
                  </div>
                </category-wrapper>

                <!-- Sysselsättning -->
                <category-wrapper category-key="2" intyg-model="cert">
                  <div mi-category category-label="KAT_2.RBK">
                    <div mi-field field-dynamic-label="DFR_28.1" filled="true">
                      <ul id="sysselsattning">
                        <li ng-repeat="sys in cert.sysselsattning">
                          <span dynamic-label key="KV_FKMU_0002.{{sys.typ}}.RBK"></span>
                        </li>
                      </ul>
                    </div>
                    <div mi-field field-dynamic-label="DFR_29.1" filled="cert.nuvarandeArbete">
                      {{cert.nuvarandeArbete}}
                    </div>
                    <div mi-field field-dynamic-label="DFR_30.1" filled="cert.arbetsmarknadspolitisktProgram">
                      {{cert.arbetsmarknadspolitisktProgram}}
                    </div>
                  </div>
                </category-wrapper>

                <!-- Diagnos -->
                <category-wrapper category-key="3" intyg-model="cert">
                  <div mi-category category-label="KAT_3.RBK">
                    <div field-wrapper field-name="diagnoser" intyg-model="cert">
                      <div mi-field field-dynamic-label="FRG_6" filled="cert.diagnoser.length > 0">
                        <div class="row">
                          <div class="col-xs-4">
                            <label class="bold">
                              <span dynamic-label key="DFR_6.2.RBK"></span>
                            </label>
                          </div>
                          <div class="col-xs-8">
                            <label class="bold">
                              <span dynamic-label key="DFR_6.1.RBK"></span>
                            </label>
                          </div>
                        </div>
                        <div class="row" ng-repeat="diagnos in cert.diagnoser">
                          <div class="col-xs-4" id="diagnosKod{{$index}}">
                            {{diagnos.diagnosKod}}
                          </div>
                          <div class="col-xs-8" id="diagnosBeskrivning{{$index}}" class="multiline">
                            {{diagnos.diagnosBeskrivning}}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </category-wrapper>

                <!-- Sjukdomens konsekvenser -->
                <category-wrapper category-key="4" intyg-model="cert">
                  <div mi-category category-label="KAT_4.RBK">
                    <div mi-field field-dynamic-label="DFR_35.1" filled="cert.funktionsnedsattning">
                      <div id="funktionsnedsattning">{{cert.funktionsnedsattning}}</div>
                    </div>
                    <div mi-field field-dynamic-label="DFR_17.1" filled="cert.aktivitetsbegransning">
                      <div id="aktivitetsbegransning">{{cert.aktivitetsbegransning}}</div>
                    </div>
                  </div>
                </category-wrapper>

                <!-- Medicinska behandlingar/åtgärder -->
                <category-wrapper category-key="5" intyg-model="cert">
                  <div mi-category category-label="KAT_5.RBK">
                    <div mi-field field-dynamic-label="DFR_19.1" filled="cert.pagaendeBehandling">
                      <div id="pagaendeBehandling">{{cert.pagaendeBehandling}}</div>
                    </div>
                    <div mi-field field-dynamic-label="DFR_20.1" filled="cert.planeradBehandling">
                      <div id="planeradBehandling">{{cert.planeradBehandling}}</div>
                    </div>
                  </div>
                </category-wrapper>

                <!-- Bedömning -->
                <category-wrapper category-key="6" intyg-model="cert">
                  <div mi-category mi-category category-label="KAT_6.RBK">
                    <field-wrapper field-name="sjukskrivningar" intyg-model="cert">
                      <div mi-field field-dynamic-label="FRG_32" filled="cert.sjukskrivningar.length > 0">
                        <div id="sjukskrivningar" sjukskrivning-view field-model="cert"></div>
                      </div>
                    </field-wrapper>
                    <field-wrapper field-name="forsakringsmedicinsktBeslutsstod" intyg-model="cert">
                      <div mi-field field-dynamic-label="DFR_37.1" filled="cert.forsakringsmedicinsktBeslutsstod">
                        <div id="forsakringsmedicinsktBeslutsstod" class="multiline">
                          {{cert.forsakringsmedicinsktBeslutsstod}}
                        </div>
                      </div>
                    </field-wrapper>
                    <field-wrapper field-name="arbetstidsforlaggning" intyg-model="cert">
                      <div mi-field field-dynamic-label="DFR_33.1" filled="cert.arbetstidsforlaggning != undefined">
                        <div boolean-view="arbetstidsforlaggning" field-model="cert"></div>
                      </div>
                    </field-wrapper>
                    <field-wrapper field-name="arbetstidsforlaggningMotivering" intyg-model="cert">
                      <div mi-field field-dynamic-label="DFR_33.2" filled="cert.arbetstidsforlaggningMotivering">
                        <div id="arbetstidsforlaggningMotivering" class="multiline">
                          {{cert.arbetstidsforlaggningMotivering}}
                        </div>
                      </div>
                    </field-wrapper>
                    <field-wrapper field-name="arbetsresor" intyg-model="cert">
                      <div mi-field field-dynamic-label="DFR_34.1" filled="cert.arbetsresor != undefined">
                        <div boolean-view="arbetsresor" field-model="cert"></div>
                      </div>
                    </field-wrapper>
                    <field-wrapper field-name="prognos" intyg-model="cert">
                      <div mi-field field-dynamic-label="DFR_39.1" filled="cert.prognos.typ">
                        <div id="prognosTyp">
                          <span dynamic-label key="KV_FKMU_0006.{{cert.prognos.typ}}.RBK"></span>
                          <span ng-show="cert.prognos.dagarTillArbete" dynamic-label
                                key="KV_FKMU_0007.{{cert.prognos.dagarTillArbete}}.RBK"></span>
                        </div>
                      </div>
                    </field-wrapper>
                  </div>
                </category-wrapper>

                <!-- Åtgärder -->
                <category-wrapper category-key="7" intyg-model="cert">
                  <div mi-category category-label="KAT_7.RBK">
                    <div mi-field field-dynamic-label="FRG_40" filled="cert.arbetslivsinriktadeAtgarder">
                      <ul id="arbetslivsinriktadeAtgarder">
                        <li ng-repeat="atgard in cert.arbetslivsinriktadeAtgarder">
                          <span dynamic-label key="KV_FKMU_0004.{{atgard.typ}}.RBK"></span>
                        </li>
                      </ul>
                    </div>
                    <div mi-field field-dynamic-label="FRG_44" filled="cert.arbetslivsinriktadeAtgarderBeskrivning">
                      <div id="arbetslivsinriktadeAtgarderBeskrivning" class="multiline">
                        {{cert.arbetslivsinriktadeAtgarderBeskrivning}}
                      </div>
                    </div>
                  </div>
                </category-wrapper>

                <!--  Övrigt -->
                <category-wrapper category-key="8" intyg-model="cert">
                  <div mi-category category-label="KAT_8.RBK">
                    <div mi-field field-dynamic-label="DFR_25.1" filled="cert.ovrigt">
                      <!--  leave  as div tag for IE8 magic bug. using span crashes angular.. -->
                      <div id="kommentar" class="tag multiline">{{cert.ovrigt}}</div>
                    </div>
                  </div>
                </category-wrapper>

                <!-- Kontakt med fk-->
                <category-wrapper category-key="9" intyg-model="cert">
                  <div mi-category category-label="KAT_9.RBK">
                    <div mi-field field-dynamic-label="DFR_26.1" filled="true">
                    <span ng-show="cert.kontaktMedFk">
                      <span id="kontaktFk-yes" message key="lisjp.label.yes"></span>
                    </span>
                      <span ng-show="!cert.kontaktMedFk">
                      <span id="kontaktFk-no" message key="lisjp.label.no"></span>
                    </span>
                    </div>
                    <div mi-field field-dynamic-label="DFR_26.2" filled="cert.anledningTillKontakt">
                      <div id="anledningtillkontakt" class="multiline">{{cert.anledningTillKontakt}}</div>
                    </div>
                  </div>
                </category-wrapper>

                <category-wrapper category-key="9999" intyg-model="cert">
                  <div mi-category category-label="KAT_9999.RBK">
                    <field-wrapper field-name="tillaggsfragor" intyg-model="cert">
                      <div mi-field field-dynamic-label="DFR_{{tillaggsfraga.id}}.1"
                           ng-repeat="tillaggsfraga in cert.tillaggsfragor" filled="tillaggsfraga.svar">
                        <div id="tillaggsfraga_{{$index}}" class="multiline">{{tillaggsfraga.svar}}</div>
                      </div>
                    </field-wrapper>
                  </div>
                </category-wrapper>

                <div class="row padding-bottom-30px">
                  <div class="col-xs-12 col-sm-7 col-md-7 col-lg-7">
                    <div class="infobox">
                      <h3>
                        <span message key="lisjp.label.confirmedby"></span>
                      </h3>
                      <h4>
                        <span message key="lisjp.label.date"></span>
                      </h4>
                      <p id="signeringsdatum">{{cert.grundData.signeringsdatum | date:'longDate'}}</p>
                      <h4>
                        <span message key="lisjp.label.contactinfo"></span>
                      </h4>
                      <p>
                        <span id="vardperson-namn"
                              class="text">{{cert.grundData.skapadAv.fullstandigtNamn}}</span><br />
                        <span id="vardperson-enhet" class="text">{{cert.grundData.skapadAv.vardenhet.enhetsnamn}}</span><br />
                        <span id="vardperson-postadress"
                              class="text">{{cert.grundData.skapadAv.vardenhet.postadress}}</span><br />
                        <span id="vardperson-postnummer-ort" class="text">{{cert.grundData.skapadAv.vardenhet.postnummer}} {{cert.grundData.skapadAv.vardenhet.postort}}</span><br />
                        <span id="vardperson-telefonnummer" class="text">{{cert.grundData.skapadAv.vardenhet.telefonnummer}}</span><br />
                      </p>
                    </div>
                  </div>
                </div>

              </div>
              <!-- intyg-body -->

            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- eof spinner -->
  </div>
</div>
