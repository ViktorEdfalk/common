<!--

    Copyright (C) 2013 Inera AB (http://www.inera.se)

    This file is part of Inera Certificate Modules (http://code.google.com/p/inera-certificate-modules).

    Inera Certificate Modules is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as
    published by the Free Software Foundation, either version 3 of the
    License, or (at your option) any later version.

    Inera Certificate Modules is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.

-->
<mi-page-head>
  <mi-breadcrumb></mi-breadcrumb>
  <!-- Content -->
  <div class="row">
    <div class="col-xs-12 col-sm-7">
      <h1>
        <span message id="viewCertificateHeader" key="modules.page-header.view-intyg.page-title"></span>
      </h1>

      <mi-certificate-header-pageingress is-replaced="certMeta.isReplaced" default-message-key="ts-bas.label.pageingress"
                                         replaced-message-key="ts-bas.label.pageingress.ersatt"></mi-certificate-header-pageingress>

      <div uib-collapse="!isCollapsed1" class="collapse">
        <span message key="modules.page-header.info.select-recipients-and-send.ts"></span>
        <span message key="modules.page-header.info.download-pdf"></span>
        <span message key="modules.page-header.info.archive"></span>
      </div>

      <button type="button" ng-click="isCollapsed1 = !isCollapsed1" class="btn btn-link btn-link-chevron"
              data-toggle="collapse">
        <span message key="modules.page-header.info.more.{{!isCollapsed1}}"></span>
      </button>

    </div>
    <div class="col-xs-12 col-sm-5">
      <latest-events cert-id="{{cert.id}}" events="certMeta.events"></latest-events>
    </div>
  </div>
</mi-page-head>
<div class="container">
  <div class="row-fluid">

    <!-- Loading spinner: visibility defined by $scope.doneLoading  -->
    <div mi-spinner label="modules.message.certificateloading" show-spinner="!doneLoading" show-content="doneLoading">
      <mi-certificate-replaced cert-meta-model="certMeta"></mi-certificate-replaced>
      <mi-certificate-action-buttons cert-model="cert" on-send="send(cert)" enable-archive="true"
                                     enable-print="true"
                                     is-replaced="certMeta.isReplaced"></mi-certificate-action-buttons>

      <mi-compact-certificate-header cert-meta-model="certMeta"></mi-compact-certificate-header>
      <uv-render-components ng-class="{'certificate-header-replaced' : certMeta.isReplaced}" config="uvConfig" view-data="cert"></uv-render-components>

      <div ng-if="!errorMessage" class="row col-xs-12 text-muted"><br><span message key="modules.view-intyg.end-of-intyg.text"></span></div>
    </div>
  </div>
</div>

<mi-page-message-icon
    id="errorMessage"
    img-path="/img/404.png"
    msg-key="{{errorMessage}}"
    ng-if="doneLoading && errorMessage">
</mi-page-message-icon>
